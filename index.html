<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>$q timeout</title>
    <script src="bower_components/angular/angular.js"></script>
    <script src="ng-q-timeout.js"></script>
  </head>
  <body ng-app="Example">
    <h1>angular-q-timeout</h1>
    <p>Open the javascript console to see the results</p>
    <script>
    angular.module('Example', ['ng-q-timeout'])
    .run(function ($q) {
      function foo() {
        var defer = $q.defer();
        setTimeout(function () {
          console.log('resolving foo, will be ignored');
          defer.resolve('foo');
        }, 200);
        return defer.promise;
      }

      foo()
      .timeout(100, function onTimeout(defer) {
        console.log('promise timed out! Good');
        defer.reject('timed out');
      })
      .then(function onSuccess() {
        throw new Error('promise worked :(');
      }, function onError(msg) {
        console.assert(msg === 'timed out', 'hmm, wrong rejection');
      });
    });
    </script>
  </body>
</html>
